# LI Database Sync System
# ============================================================================
#
# Per CLAUDE.md section 3.3:
# - Uses pg_dump/pg_restore for full database synchronization
# - Sync interval is configurable via Kubernetes CronJob
# - Manual sync trigger available from synapse-admin-li
# - File lock prevents concurrent syncs
#
# Deployment Files:
# - cronjob.yaml  - Kubernetes CronJob for periodic sync (APPLY THIS FILE)
#
# Implementation:
# - CronJob runs every 6 hours by default (configurable in cronjob.yaml)
# - Uses pg_dump to export main database
# - Uses psql to import dump into LI database (full replacement)
# - File lock prevents concurrent sync operations
# - Checkpoint file tracks sync history and status
#
# Media Sync:
# - NOT needed - LI uses main MinIO directly via S3 API (shared storage)
#
# Manual Sync:
# - Trigger via synapse-admin-li "Sync Now" button
# - Or create a Job manually: kubectl create job --from=cronjob/synapse-li-database-sync manual-sync-$(date +%s)
#
# Monitoring:
# - Check CronJob status: kubectl get cronjob synapse-li-database-sync -n matrix
# - Check recent Jobs: kubectl get jobs -n matrix -l app.kubernetes.io/name=sync-system
# - View logs: kubectl logs -n matrix -l app.kubernetes.io/component=database-sync
#
# ============================================================================
#
# To deploy:
#   kubectl apply -f cronjob.yaml
#
# To change schedule (edit cronjob.yaml spec.schedule):
#   "0 */6 * * *"  - Every 6 hours (default)
#   "0 */4 * * *"  - Every 4 hours
#   "0 */12 * * *" - Every 12 hours
#   "0 0 * * *"    - Daily at midnight
#
# ============================================================================
